'use client'
import { cn } from '@/lib/utils'
import { useState } from 'react'
import 'swiper/css'
import 'swiper/css/effect-coverflow'
// import 'swiper/css/pagination'
import { Autoplay, Navigation, Pagination } from 'swiper/modules'
import { Swiper, SwiperSlide } from 'swiper/react'

interface Props {
	className?: string
}

export const ReviewsSLider: React.FC<Props> = ({ className }) => {
	const reviews = [
		{
			date: '12 февраля 2025',
			platform: 'Яндекс',
			user: 'Алексей Ковалёв',
			rating: [1, 2, 3, 4, 5],
			review:
				'Заказывал демонтаж стен в квартире. Ребята работали аккуратно, использовали профессиональное оборудование. Весь мусор вывезли в тот же день. Цены адекватные, без скрытых платежей. Очень доволен результатом, рекомендую!',
			tags: [
				'#аккуратный_демонтаж',
				'#профессиональное_оборудование',
				'#вывоз_мусора',
			],
		},
		{
			date: '28 января 2025',
			platform: '2ГИС',
			user: 'Мария Семёнова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Нужно было снести старый потолок с балками. Обратилась в эту компанию – не пожалела. Работали быстро, чисто, соблюдали все сроки. После себя убрали идеально. Отличные специалисты, буду обращаться ещё!',
			tags: ['#демонтаж_потолка', '#соблюдение_сроков', '#чистая_работа'],
		},
		{
			date: '15 января 2025',
			platform: 'Яндекс',
			user: 'Дмитрий Волков',
			rating: [1, 2, 3, 4, 5],
			review:
				'Делали демонтаж полов в доме. Приятно удивлен качеством работы. Всё сделали аккуратно, не повредили коммуникации. Мусор вывезли сразу. Цена соответствует качеству. Спасибо за профессиональный подход!',
			tags: ['#демонтаж_полов', '#аккуратность', '#качественная_работа'],
		},
		{
			date: '5 января 2025',
			platform: '2ГИС',
			user: 'Елена Петрова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Требовалось убрать межкомнатные перегородки. Мастера приехали вовремя, всё объяснили, сделали быстро и качественно. Особенно порадовал вывоз строительного мусора – очень удобно! Рекомендую всем.',
			tags: ['#демонтаж_перегородок', '#быстрая_работа', '#удобный_сервис'],
		},
		{
			date: '22 декабря 2024',
			platform: 'Яндекс',
			user: 'Сергей Иванов',
			rating: [1, 2, 3, 4, 5],
			review:
				'Комплексный демонтаж в офисе: стены, потолки, полы. Справились за 3 дня! Работали слаженно, использовали современную технику. Мусор вывозили ежедневно. Очень профессиональная команда, рекомендую!',
			tags: [
				'#комплексный_демонтаж',
				'#слаженная_команда',
				'#современная_техника',
			],
		},
		{
			date: '10 декабря 2024',
			platform: '2ГИС',
			user: 'Ольга Козлова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Нужно было снести старую стену и вывезти мусор. Мастера приехали точно в оговоренное время, работали без перерывов. Всё сделали качественно, чисто убрали. Цена полностью соответствовала смете. Спасибо!',
			tags: ['#демонтаж_стен', '#точность', '#честная_цена'],
		},
		{
			date: '30 ноября 2024',
			platform: 'Яндекс',
			user: 'Андрей Николаев',
			rating: [1, 2, 3, 4, 5],
			review:
				'Делали демонтаж подвесных потолков в торговом зале. Работали в нерабочие часы, чтобы не мешать клиентам. Всё аккуратно демонтировали, мусор вывезли. Очень ответственный подход, рекомендую компанию!',
			tags: ['#демонтаж_потолков', '#гибкий_график', '#ответственный_подход'],
		},
		{
			date: '18 ноября 2024',
			platform: '2ГИС',
			user: 'Татьяна Морозова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Требовался срочный вывоз строительного мусора после ремонта. Ребята приехали через 2 часа после звонка, быстро всё погрузили и увезли. Цена адекватная, работа качественная. Очень выручили, спасибо!',
			tags: ['#вывоз_мусора', '#срочный_выезд', '#качественный_сервис'],
		},
		{
			date: '5 ноября 2024',
			platform: 'Яндекс',
			user: 'Виктор Соколов',
			rating: [1, 2, 3, 4, 5],
			review:
				'Демонтаж бетонных перегородок в подвале. Работа сложная, но специалисты справились отлично. Использовали алмазную резку, было минимум пыли. Мусор вывезли в контейнерах. Профессионалы своего дела!',
			tags: ['#демонтаж_бетона', '#алмазная_резка', '#минимум_пыли'],
		},
		{
			date: '25 октября 2024',
			platform: '2ГИС',
			user: 'Надежда Васнецова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Разбирали старые деревянные полы в дачном доме. Мастера работали аккуратно, сохранили балки для повторного использования. Весь мусор убрали, территорию подмели. Очень довольна, всем рекомендую!',
			tags: ['#демонтаж_полов', '#аккуратность', '#бережное_отношение'],
		},
		{
			date: '12 октября 2024',
			platform: 'Яндекс',
			user: 'Павел Громов',
			rating: [1, 2, 3, 4, 5],
			review:
				'Комплексный демонтаж в квартире перед капитальным ремонтом. Сделали всё: стены, потолки, полы, сантехнику. Работали быстро, чисто, мусор вывозили ежедневно. Отличная организация процесса!',
			tags: [
				'#комплексный_демонтаж',
				'#быстро_и_чисто',
				'#отличная_организация',
			],
		},
		{
			date: '30 сентября 2024',
			platform: '2ГИС',
			user: 'Ирина Белова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Демонтировали гипсокартонные перегородки в офисе. Работали вечером, чтобы не мешать сотрудникам. Всё сделали аккуратно, убрали за собой. Цена соответствует качеству. Буду рекомендовать коллегам!',
			tags: ['#демонтаж_перегородок', 'работа_вечером', '#аккуратный_подход'],
		},
		{
			date: '15 сентября 2024',
			platform: 'Яндекс',
			user: 'Максим Орлов',
			rating: [1, 2, 3, 4, 5],
			review:
				'Нужно было снести несущую стену с усилением. Специалисты провели расчеты, сделали всё по технологии. Работали с применением современного оборудования. Результатом полностью доволен!',
			tags: [
				'#демонтаж_несущих',
				'#технологичный_подход',
				'#современное_оборудование',
			],
		},
		{
			date: '2 сентября 2024',
			platform: '2ГИС',
			user: 'Светлана Кузнецова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Вывоз строительного мусора после демонтажа. Приехали вовремя, быстро погрузили, оставили чистое место. Цена фиксированная, без скрытых доплат. Очень удобный и надежный сервис, рекомендую!',
			tags: ['#вывоз_мусора', '#фиксированная_цена', '#надежный_сервис'],
		},
		{
			date: '20 августа 2024',
			platform: 'Яндекс',
			user: 'Антон Павлов',
			rating: [1, 2, 3, 4, 5],
			review:
				'Демонтаж натяжных потолков в нескольких комнатах. Сделали аккуратно, не повредили стены и проводку. Мусор весь убрали, помещение подмели. Профессиональная работа за разумные деньги!',
			tags: ['#демонтаж_потолков', '#аккуратная_работа', '#разумные_цены'],
		},
		{
			date: '5 августа 2024',
			platform: '2ГИС',
			user: 'Юлия Степанова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Требовался срочный демонтаж полов после затопления. Ребята приехали в тот же день, оперативно всё разобрали, просушили помещение. Очень выручили в сложной ситуации. Большое спасибо!',
			tags: ['#демонтаж_полов', '#срочный_выезд', '#помощь_в_сложной_ситуации'],
		},
		{
			date: '22 июля 2024',
			platform: 'Яндекс',
			user: 'Роман Крылов',
			rating: [1, 2, 3, 4, 5],
			review:
				'Комплексный демонтаж в старом здании: стены, перегородки, полы. Работали профессионально, соблюдали технику безопасности. Весь мусор вывезли организованно. Отличная компания для сложных задач!',
			tags: [
				'#комплексный_демонтаж',
				'#техника_безопасности',
				'#организованная_работа',
			],
		},
		{
			date: '10 июля 2024',
			platform: '2ГИС',
			user: 'Екатерина Романова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Демонтаж кирпичных перегородок в квартире. Мастера использовали профессиональный инструмент, работали с минимальным шумом. После себя всё убрали, вывезли мусор. Очень довольна сервисом!',
			tags: [
				'#демонтаж_перегородок',
				'#профессиональный_инструмент',
				'#минимальный_шум',
			],
		},
		{
			date: '28 июня 2024',
			platform: 'Яндекс',
			user: 'Артём Васильев',
			rating: [1, 2, 3, 4, 5],
			review:
				'Вывоз строительного мусора с нескольких объектов. Работают оперативно, цены прозрачные, есть разные варианты контейнеров. Удобно, что можно заказать по телефону. Рекомендую для регулярного сотрудничества!',
			tags: ['#вывоз_мусора', '#прозрачные_цены', '#удобный_заказ'],
		},
		{
			date: '15 июня 2024',
			platform: '2ГИС',
			user: 'Наталья Фёдорова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Демонтаж стен из газобетона. Специалисты работали аккуратно, использовали специальное оборудование. Весь мусор сразу грузили в контейнеры. Качественная работа, соблюдение сроков. Спасибо!',
			tags: [
				'#демонтаж_стен',
				'#специальное_оборудование',
				'#соблюдение_сроков',
			],
		},
		{
			date: '3 июня 2024',
			platform: 'Яндекс',
			user: 'Владимир Семёнов',
			rating: [1, 2, 3, 4, 5],
			review:
				'Демонтаж старых деревянных перегородок на даче. Работали быстро, не повредили полы и стены. Весь мусор вывезли, территорию убрали. Приятные в общении специалисты, качественная работа!',
			tags: ['#демонтаж_перегородок', '#быстрая_работа', '#приятное_общение'],
		},
		{
			date: '20 мая 2024',
			platform: '2ГИС',
			user: 'Оксана Лебедева',
			rating: [1, 2, 3, 4, 5],
			review:
				'Нужно было убрать старый линолеум и вывезти мусор. Приехали вовремя, оперативно всё сделали. Цена соответствовала озвученной. Очень удобный сервис, особенно для мелких работ. Рекомендую!',
			tags: ['#демонтаж_покрытий', '#оперативная_работа', '#удобный_сервис'],
		},
		{
			date: '8 мая 2024',
			platform: 'Яндекс',
			user: 'Денис Комаров',
			rating: [1, 2, 3, 4, 5],
			review:
				'Комплексный демонтаж в кафе перед реконструкцией. Сделали всё: стены, полы, потолки, сантехнику. Работали по графику, не мешая соседним заведениям. Профессиональный подход к сложным задачам!',
			tags: [
				'#комплексный_демонтаж',
				'#работа_по_графику',
				'#профессиональный_подход',
			],
		},
		{
			date: '25 апреля 2024',
			platform: '2ГИС',
			user: 'Лариса Новикова',
			rating: [1, 2, 3, 4, 5],
			review:
				'Демонтаж гипсокартонных конструкций на потолке. Сделали аккуратно, не повредили проводку. Весь мусор упаковали и вывезли. Приятно работать с профессионалами, которые ценят свою репутацию!',
			tags: ['#демонтаж_конструкций', '#аккуратный_подход', '#профессионализм'],
		},
	]

	interface TruncatedTextProps {
		text: string
		maxLength: number
		className?: string
		buttonClassName?: string
		showMoreText?: string
		showLessText?: string
		// Опционально: количество строк вместо символов
		maxLines?: number
	}

	const TruncatedText = ({
		text,
		maxLength,
		className = '',
		buttonClassName = '',
		showMoreText = 'читать полностью',
		showLessText = 'свернуть',
		maxLines,
	}: TruncatedTextProps) => {
		const [isExpanded, setIsExpanded] = useState<boolean>(false)

		const handleToggle = () => setIsExpanded(!isExpanded)

		// Если используется ограничение по строкам
		if (maxLines) {
			return (
				<div>
					<div
						className={cn(className, !isExpanded && `line-clamp-${maxLines}`)}
					>
						{text}
					</div>
					<button
						onClick={handleToggle}
						className={cn(
							'mt-2 text-(--accent-color1) hover:text-(--accent-color2) text-sm font-medium transition-colors',
							buttonClassName
						)}
						type='button'
					>
						{isExpanded ? showLessText : showMoreText}
					</button>
				</div>
			)
		}

		// Ограничение по символам
		if (text.length <= maxLength) {
			return <p className={'text-base leading-5'}>{text}</p>
		}

		return (
			<div>
				<p className={'text-base leading-5'}>
					{isExpanded ? text : `${text.slice(0, maxLength)}...`}
				</p>
				<button
					onClick={handleToggle}
					className={cn(
						'mt-2 text-(--accent-color1) hover:text-(--accent-color2) text-sm font-medium transition-colors',
						buttonClassName
					)}
					type='button'
				>
					{isExpanded ? showLessText : showMoreText}
				</button>
			</div>
		)
	}

	return (
		<div className={cn(className)}>
			<div className={cn(className)}>
				<Swiper
					loop={true}
					grabCursor={true}
					centeredSlides={false}
					// slidesPerView={3}
					// spaceBetween={0}
					pagination={false}
					navigation={false}
					autoplay={{
						delay: 4000, // 4 секунды
						disableOnInteraction: false,
						pauseOnMouseEnter: true,
						waitForTransition: true,
					}}
					speed={1000} // 1 секунда анимации
					modules={[Navigation, Pagination, Autoplay]}
					className=''
					breakpoints={{
						320: {
							slidesPerView: 1,
						},
						640: {
							slidesPerView: 1.2,
							spaceBetween: 10,
						},
						768: {
							slidesPerView: 1.3,
							spaceBetween: 5,
						},

						1024: {
							slidesPerView: 2,
							spaceBetween: 10,
						},
						1280: {
							slidesPerView: 2.5,
							spaceBetween: 20,
						},
						1520: {
							slidesPerView: 3,
							spaceBetween: 20,
						},
					}}
				>
					{reviews.map(review => (
						<SwiperSlide className={''}>
							<div key={Math.random()}>
								<div className='h-64 lg:h-72 bg-(--layer-color) p-4 rounded-[20px] overflow-y-auto '>
									<div className='review-header flex items-center mb-2'>
										<div className='ms-2'>
											<h5 className='mb-0 text-[24px] font-semibold'>
												{review.user}
											</h5>
											<small className='text-[20px] font-normal'>
												{review.date}{' '}
											</small>
										</div>
									</div>
									<div className='rating flex text-warning'>
										{review.rating.map(() => (
											<img
												width={'30px'}
												key={Math.random()}
												src={'/svg/rating.svg'}
												alt='rating'
											/>
										))}
									</div>
									<div className='md:w-3/4'>
										<TruncatedText text={review.review} maxLength={200} />
									</div>
								</div>
							</div>
						</SwiperSlide>
					))}
				</Swiper>
			</div>
		</div>
	)
}
